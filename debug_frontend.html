
<!DOCTYPE html>
<html>
<head>
    <title>YOLOv11 攝影機系統調試工具</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px;
            background: #1f2937;
            color: white;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .test-section {
            border: 2px solid #4f46e5;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            background: #374151;
        }
        .success { border-left: 4px solid #10b981; }
        .error { border-left: 4px solid #ef4444; }
        .info { border-left: 4px solid #3b82f6; }
        button {
            background: #4f46e5;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #4338ca; }
        .result {
            background: #1f2937;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>YOLOv11 攝影機系統調試工具</h1>
        
        <div class="test-section info">
            <h2>基本連接測試</h2>
            <button onclick="testHealth()">健康檢查</button>
            <button onclick="testCameras()">攝影機列表</button>
            <button onclick="testStream()">串流測試</button>
            <div id="basic-results" class="result"></div>
        </div>

        <div class="test-section info">
            <h2>攝影機操作測試</h2>
            <button onclick="testToggleCamera()">切換攝影機狀態</button>
            <button onclick="testCameraScan()">掃描攝影機</button>
            <div id="camera-results" class="result"></div>
        </div>

        <div class="test-section info">
            <h2>React Query Hook 測試</h2>
            <button onclick="testReactQueryAPI()">模擬前端API調用</button>
            <div id="query-results" class="result"></div>
        </div>

        <div class="test-section info">
            <h2>串流顯示測試</h2>
            <div>
                <p>即時串流測試:</p>
                <img 
                    id="stream-test"
                    src="http://localhost:8001/api/v1/frontend/cameras/0/stream"
                    alt="攝影機串流測試"
                    style="max-width: 400px; border: 1px solid #6b7280;"
                    onload="logResult('stream-display', '串流圖片載入成功')"
                    onerror="logResult('stream-display', '串流圖片載入失敗: ' + this.src)"
                />
            </div>
            <div id="stream-display" class="result"></div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8001/api/v1'; 
                '/api/v1/frontend/models'
            ];
            
            const results = document.getElementById('api-results');
            results.innerHTML = '';
            
            for (const api of apis) {
                try {
                    const response = await fetch(`http://localhost:8001${api}`);
                    const data = await response.json();
                    
                    const div = document.createElement('div');
                    div.className = response.ok ? 'success' : 'error';
                    
                    let modelsInfo = '';
                    if (data.value && Array.isArray(data.value)) {
                        modelsInfo = `模型: [${data.value.map(m => m.name || m).join(', ')}]`;
                    } else if (Array.isArray(data)) {
                        modelsInfo = `模型: [${data.map(m => m.name || m).join(', ')}]`;
                    }
                    
                    div.innerHTML = `
                        <strong>${api}</strong>: ${response.status} 
                        ${modelsInfo}
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    `;
                    results.appendChild(div);
                } catch (error) {
                    const div = document.createElement('div');
                    div.className = 'error';
                    div.innerHTML = `<strong>${api}</strong>: 錯誤 - ${error.message}`;
                    results.appendChild(div);
                }
            }
        }
        
        // 頁面載入時檢查 API
        checkAPIs();
        
        // 每5秒重新檢查
        setInterval(checkAPIs, 5000);
        
        console.log('=== 前端調試信息 ===');
        console.log('1. 檢查 React 應用是否載入');
        console.log('2. 檢查 selectedModel 狀態');
        console.log('3. 檢查模型選擇器選項');
    </script>
</body>
</html>
