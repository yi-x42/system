<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YOLOv11 資料庫設計 - Table Schema & ERM</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft JhengHei', 'Segoe UI', Arial, sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(45deg, #3498db, #2ecc71);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .nav-tabs {
            background: #f8f9fa;
            padding: 0;
            display: flex;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .tab-button {
            background: none;
            border: none;
            padding: 20px 30px;
            font-size: 1.1em;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            flex: 1;
            text-align: center;
        }
        
        .tab-button:hover {
            background: #e9ecef;
        }
        
        .tab-button.active {
            background: white;
            border-bottom-color: #3498db;
            color: #3498db;
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
            padding: 40px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .erm-diagram {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            overflow-x: auto;
        }
        
        .erm-diagram pre {
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 12px;
            line-height: 1.4;
            color: #2c3e50;
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #e0e0e0;
        }
        
        .relationship-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .relationship-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #3498db;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .relationship-card h4 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .table-section {
            margin: 40px 0;
        }
        
        .table-header {
            background: linear-gradient(90deg, #f8f9fa, #e9ecef);
            padding: 20px;
            border-radius: 10px 10px 0 0;
            border-left: 5px solid #3498db;
        }
        
        .table-header h3 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .ddl-code {
            background: #2c3e50;
            color: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
        }
        
        .field-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 0 0 10px 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .field-table th {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            padding: 15px 10px;
            text-align: center;
            font-weight: 600;
        }
        
        .field-table td {
            padding: 12px 10px;
            border: 1px solid #e0e0e0;
            text-align: center;
        }
        
        .field-table tbody tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        .field-table tbody tr:hover {
            background-color: #e3f2fd;
        }
        
        .field-name {
            font-weight: bold;
            color: #2c3e50;
            font-family: 'Consolas', 'Monaco', monospace;
        }
        
        .data-type {
            color: #8e44ad;
            font-family: 'Consolas', 'Monaco', monospace;
            background: #f8f9fa;
            padding: 3px 6px;
            border-radius: 3px;
        }
        
        .required-yes {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .required-no {
            color: #95a5a6;
        }
        
        .constraint {
            color: #27ae60;
            font-size: 0.9em;
        }
        
        .description {
            text-align: left;
            color: #555;
        }
        
        .stats-bar {
            background: rgba(52, 152, 219, 0.1);
            padding: 20px;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .stat-item {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            min-width: 120px;
        }
        
        .stat-number {
            font-size: 1.8em;
            font-weight: bold;
            color: #3498db;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9em;
            margin-top: 5px;
        }
        
        .constraints-section {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 20px;
            border-radius: 10px;
            margin: 30px 0;
        }
        
        .constraints-section h4 {
            color: #856404;
            margin-bottom: 15px;
        }
        
        .constraint-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .constraint-item {
            background: white;
            padding: 10px;
            border-radius: 5px;
            border-left: 3px solid #f39c12;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
        }
        
        .footer {
            background: #34495e;
            color: white;
            text-align: center;
            padding: 30px;
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .tab-content {
                padding: 20px;
            }
            
            .stats-bar {
                flex-direction: column;
                align-items: center;
            }
            
            .field-table {
                font-size: 12px;
            }
            
            .field-table th, .field-table td {
                padding: 8px 5px;
            }
        }
        
        .highlight {
            background: linear-gradient(45deg, #f39c12, #e67e22);
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
            margin-left: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎯 YOLOv11 資料庫設計</h1>
            <p>Table Schema & Entity Relationship Model</p>
        </div>
        
        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-number">3</div>
                <div class="stat-label">資料表</div>
            </div>
            <div class="stat-item">
                <div class="stat-number">68</div>
                <div class="stat-label">總欄位數</div>
            </div>
            <div class="stat-item">
                <div class="stat-number">PostgreSQL</div>
                <div class="stat-label">資料庫</div>
            </div>
            <div class="stat-item">
                <div class="stat-number">2025.7.23</div>
                <div class="stat-label">建立日期</div>
            </div>
        </div>
        
        <nav class="nav-tabs">
            <button class="tab-button active" onclick="openTab(event, 'erm-tab')">ERM 關係模型</button>
            <button class="tab-button" onclick="openTab(event, 'schema-tab')">Table Schema</button>
        </nav>
        
        <div id="erm-tab" class="tab-content active">
            <h2>🔗 實體關係模型 (Entity Relationship Model)</h2>
            
            <div class="erm-diagram">
                <h3>實體關係圖</h3>
                <pre>
┌─────────────────────┐
│   ANALYSIS_RECORDS  │  主實體 - 分析記錄
├─────────────────────┤
│ * id (PK)           │
│ * video_path        │
│ * video_name        │
│ * analysis_type     │
│ * status            │
│ * created_at        │
│   updated_at        │
│   total_detections  │
│   unique_objects    │
│   progress          │
│   duration          │
│   fps               │
│   total_frames      │
│   error_message     │
│   model_version     │
│   processed_frames  │
│   analysis_duration │
│   output_path       │
└─────────────────────┘
         │
         │ 1:N
         │
    ┌────▼────────────────┐                ┌────────────────────┐
    │  DETECTION_RESULTS  │                │  BEHAVIOR_EVENTS   │
    ├─────────────────────┤                ├────────────────────┤
    │ * id (PK)           │                │ * id (PK)          │
    │ * analysis_id (FK)  │◄──────────────►│ * analysis_id (FK) │
    │ * timestamp         │                │ * timestamp        │
    │ * frame_number      │                │ * event_type       │
    │ * object_info       │                │ * object_type      │
    │ * object_type       │                │ * severity         │
    │ * confidence        │                │ * position_x       │
    │ * bbox_x1, y1       │                │ * position_y       │
    │ * bbox_x2, y2       │                │ * description      │
    │ * center_x, y       │                │   duration         │
    │   area              │                │   event_chinese    │
    │   velocity_x, y     │                │   object_chinese   │
    │   track_id          │                │   zone             │
    │   zone              │                │   participant_count│
    │   quality_score     │                │   risk_score       │
    │   (其他屬性...)     │                │   alert_level      │
    └─────────────────────┘                │   metadata         │
                                           └────────────────────┘
                </pre>
            </div>
            
            <div class="relationship-info">
                <div class="relationship-card">
                    <h4>🔗 主要關聯 1:N</h4>
                    <p><strong>analysis_records</strong> → <strong>detection_results</strong></p>
                    <p>一個分析記錄包含多個檢測結果</p>
                    <p>外鍵: detection_results.analysis_id</p>
                </div>
                
                <div class="relationship-card">
                    <h4>🔗 主要關聯 1:N</h4>
                    <p><strong>analysis_records</strong> → <strong>behavior_events</strong></p>
                    <p>一個分析記錄包含多個行為事件</p>
                    <p>外鍵: behavior_events.analysis_id</p>
                </div>
                
                <div class="relationship-card">
                    <h4>🔗 間接關聯 N:M</h4>
                    <p><strong>detection_results</strong> ↔ <strong>behavior_events</strong></p>
                    <p>透過 analysis_id + timestamp 關聯</p>
                    <p>檢測結果可能觸發行為事件</p>
                </div>
            </div>
            
            <div style="background: #e8f5e8; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h4>📋 符號說明</h4>
                <ul style="list-style: none; padding: 0;">
                    <li><strong>*</strong> : 必填欄位 (NOT NULL)</li>
                    <li><strong>PK</strong> : 主鍵 (Primary Key)</li>
                    <li><strong>FK</strong> : 外鍵 (Foreign Key)</li>
                    <li><strong>1:N</strong> : 一對多關聯</li>
                    <li><strong>N:M</strong> : 多對多關聯</li>
                </ul>
            </div>
        </div>
        
        <div id="schema-tab" class="tab-content">
            <h2>📊 資料表結構 (Table Schema)</h2>
            
            <!-- Analysis Records Table -->
            <div class="table-section">
                <div class="table-header">
                    <h3>📋 分析記錄表 (analysis_records)</h3>
                    <p>儲存每次影片分析任務的基本資訊、進度狀態和統計結果</p>
                </div>
                
                <div class="ddl-code">
CREATE TABLE analysis_records (
    id                  SERIAL          PRIMARY KEY,
    created_at          TIMESTAMP       NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at          TIMESTAMP       DEFAULT CURRENT_TIMESTAMP,
    video_path          VARCHAR(500)    NOT NULL,
    video_name          VARCHAR(255)    NOT NULL,
    analysis_type       VARCHAR(50)     NOT NULL DEFAULT 'detection',
    status              VARCHAR(50)     NOT NULL DEFAULT 'processing',
    total_detections    INTEGER         NOT NULL DEFAULT 0,
    unique_objects      INTEGER         NOT NULL DEFAULT 0,
    duration            FLOAT           DEFAULT NULL,
    fps                 FLOAT           DEFAULT NULL,
    total_frames        INTEGER         DEFAULT NULL,
    progress            FLOAT           NOT NULL DEFAULT 0.0,
    error_message       TEXT            DEFAULT NULL,
    model_version       VARCHAR(50)     DEFAULT NULL,
    processed_frames    INTEGER         NOT NULL DEFAULT 0,
    analysis_duration   FLOAT           DEFAULT NULL,
    output_path         VARCHAR(500)    DEFAULT NULL
);
                </div>
                
                <table class="field-table">
                    <thead>
                        <tr>
                            <th>欄位名稱</th>
                            <th>資料型別</th>
                            <th>必填</th>
                            <th>預設值</th>
                            <th>說明</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td class="field-name">id</td><td class="data-type">SERIAL</td><td class="required-yes">✓</td><td>AUTO</td><td class="description">主鍵，自動遞增</td></tr>
                        <tr><td class="field-name">created_at</td><td class="data-type">TIMESTAMP</td><td class="required-yes">✓</td><td>CURRENT_TIME</td><td class="description">建立時間戳記</td></tr>
                        <tr><td class="field-name">updated_at</td><td class="data-type">TIMESTAMP</td><td class="required-no">❌</td><td>CURRENT_TIME</td><td class="description">最後更新時間</td></tr>
                        <tr><td class="field-name">video_path</td><td class="data-type">VARCHAR(500)</td><td class="required-yes">✓</td><td>-</td><td class="description">影片檔案完整路徑</td></tr>
                        <tr><td class="field-name">video_name</td><td class="data-type">VARCHAR(255)</td><td class="required-yes">✓</td><td>-</td><td class="description">影片檔案名稱</td></tr>
                        <tr><td class="field-name">analysis_type</td><td class="data-type">VARCHAR(50)</td><td class="required-yes">✓</td><td>'detection'</td><td class="description">分析類型 (detection/annotation)</td></tr>
                        <tr><td class="field-name">status</td><td class="data-type">VARCHAR(50)</td><td class="required-yes">✓</td><td>'processing'</td><td class="description">處理狀態 (processing/completed/failed)</td></tr>
                        <tr><td class="field-name">total_detections</td><td class="data-type">INTEGER</td><td class="required-yes">✓</td><td>0</td><td class="description">總檢測物件數量</td></tr>
                        <tr><td class="field-name">unique_objects</td><td class="data-type">INTEGER</td><td class="required-yes">✓</td><td>0</td><td class="description">唯一物件類型數量</td></tr>
                        <tr><td class="field-name">duration</td><td class="data-type">FLOAT</td><td class="required-no">❌</td><td>NULL</td><td class="description">影片長度 (秒)</td></tr>
                        <tr><td class="field-name">fps</td><td class="data-type">FLOAT</td><td class="required-no">❌</td><td>NULL</td><td class="description">影片幀率</td></tr>
                        <tr><td class="field-name">total_frames</td><td class="data-type">INTEGER</td><td class="required-no">❌</td><td>NULL</td><td class="description">影片總幀數</td></tr>
                        <tr><td class="field-name">progress</td><td class="data-type">FLOAT</td><td class="required-yes">✓</td><td>0.0</td><td class="description">處理進度 (0.0-1.0)</td></tr>
                        <tr><td class="field-name">error_message</td><td class="data-type">TEXT</td><td class="required-no">❌</td><td>NULL</td><td class="description">錯誤訊息</td></tr>
                        <tr><td class="field-name">model_version</td><td class="data-type">VARCHAR(50)</td><td class="required-no">❌</td><td>NULL</td><td class="description">YOLO模型版本</td></tr>
                        <tr><td class="field-name">processed_frames</td><td class="data-type">INTEGER</td><td class="required-yes">✓</td><td>0</td><td class="description">已處理的幀數</td></tr>
                        <tr><td class="field-name">analysis_duration</td><td class="data-type">FLOAT</td><td class="required-no">❌</td><td>NULL</td><td class="description">分析耗時 (秒)</td></tr>
                        <tr><td class="field-name">output_path</td><td class="data-type">VARCHAR(500)</td><td class="required-no">❌</td><td>NULL</td><td class="description">輸出檔案路徑</td></tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Detection Results Table -->
            <div class="table-section">
                <div class="table-header">
                    <h3>🔍 檢測結果表 (detection_results)</h3>
                    <p>儲存每個檢測到的物件詳細資訊，包含位置、信心度、追蹤資料等</p>
                </div>
                
                <div class="ddl-code">
CREATE TABLE detection_results (
    id                  SERIAL          PRIMARY KEY,
    created_at          TIMESTAMP       NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at          TIMESTAMP       DEFAULT CURRENT_TIMESTAMP,
    analysis_id         INTEGER         NOT NULL REFERENCES analysis_records(id) ON DELETE CASCADE,
    timestamp           FLOAT           NOT NULL,
    frame_number        INTEGER         NOT NULL,
    object_info         JSONB           NOT NULL,
    object_type         VARCHAR(50)     NOT NULL,
    object_chinese      VARCHAR(50)     DEFAULT NULL,
    confidence          FLOAT           NOT NULL,
    bbox_x1             FLOAT           NOT NULL,
    bbox_y1             FLOAT           NOT NULL,
    bbox_x2             FLOAT           NOT NULL,
    bbox_y2             FLOAT           NOT NULL,
    center_x            FLOAT           NOT NULL,
    center_y            FLOAT           NOT NULL,
    area                FLOAT           DEFAULT NULL,
    velocity_x          FLOAT           DEFAULT NULL,
    velocity_y          FLOAT           DEFAULT NULL,
    velocity_magnitude  FLOAT           DEFAULT NULL,
    track_id            VARCHAR(50)     DEFAULT NULL,
    zone                VARCHAR(50)     DEFAULT NULL,
    zone_chinese        VARCHAR(50)     DEFAULT NULL,
    distance_to_camera  FLOAT           DEFAULT NULL,
    relative_size       FLOAT           DEFAULT NULL,
    is_moving           BOOLEAN         DEFAULT NULL,
    occlusion_level     FLOAT           DEFAULT NULL,
    quality_score       FLOAT           DEFAULT NULL
);
                </div>
                
                <table class="field-table">
                    <thead>
                        <tr>
                            <th>欄位名稱</th>
                            <th>資料型別</th>
                            <th>必填</th>
                            <th>約束條件</th>
                            <th>說明</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td class="field-name">id</td><td class="data-type">SERIAL</td><td class="required-yes">✓</td><td class="constraint">PK</td><td class="description">主鍵，自動遞增</td></tr>
                        <tr><td class="field-name">created_at</td><td class="data-type">TIMESTAMP</td><td class="required-yes">✓</td><td>-</td><td class="description">建立時間戳記</td></tr>
                        <tr><td class="field-name">updated_at</td><td class="data-type">TIMESTAMP</td><td class="required-no">❌</td><td>-</td><td class="description">最後更新時間</td></tr>
                        <tr><td class="field-name">analysis_id</td><td class="data-type">INTEGER</td><td class="required-yes">✓</td><td class="constraint">FK, CASCADE</td><td class="description">關聯分析記錄ID</td></tr>
                        <tr><td class="field-name">timestamp</td><td class="data-type">FLOAT</td><td class="required-yes">✓</td><td>-</td><td class="description">影片中的時間點 (秒)</td></tr>
                        <tr><td class="field-name">frame_number</td><td class="data-type">INTEGER</td><td class="required-yes">✓</td><td>-</td><td class="description">幀編號</td></tr>
                        <tr><td class="field-name">object_info</td><td class="data-type">JSONB</td><td class="required-yes">✓</td><td>-</td><td class="description">完整物件資訊JSON</td></tr>
                        <tr><td class="field-name">object_type</td><td class="data-type">VARCHAR(50)</td><td class="required-yes">✓</td><td>-</td><td class="description">物件類型 (person, car, etc.)</td></tr>
                        <tr><td class="field-name">object_chinese</td><td class="data-type">VARCHAR(50)</td><td class="required-no">❌</td><td>-</td><td class="description">物件中文名稱</td></tr>
                        <tr><td class="field-name">confidence</td><td class="data-type">FLOAT</td><td class="required-yes">✓</td><td class="constraint">0.0-1.0</td><td class="description">檢測信心度</td></tr>
                        <tr style="background: #e8f5e8;"><td class="field-name">bbox_x1 <span class="highlight">修正</span></td><td class="data-type">FLOAT</td><td class="required-yes">✓</td><td>-</td><td class="description">邊界框左上角X座標</td></tr>
                        <tr style="background: #e8f5e8;"><td class="field-name">bbox_y1 <span class="highlight">修正</span></td><td class="data-type">FLOAT</td><td class="required-yes">✓</td><td>-</td><td class="description">邊界框左上角Y座標</td></tr>
                        <tr style="background: #e8f5e8;"><td class="field-name">bbox_x2 <span class="highlight">修正</span></td><td class="data-type">FLOAT</td><td class="required-yes">✓</td><td>-</td><td class="description">邊界框右下角X座標</td></tr>
                        <tr style="background: #e8f5e8;"><td class="field-name">bbox_y2 <span class="highlight">修正</span></td><td class="data-type">FLOAT</td><td class="required-yes">✓</td><td>-</td><td class="description">邊界框右下角Y座標</td></tr>
                        <tr style="background: #e3f2fd;"><td class="field-name">center_x <span class="highlight">新增</span></td><td class="data-type">FLOAT</td><td class="required-yes">✓</td><td>-</td><td class="description">物件中心X座標</td></tr>
                        <tr style="background: #e3f2fd;"><td class="field-name">center_y <span class="highlight">新增</span></td><td class="data-type">FLOAT</td><td class="required-yes">✓</td><td>-</td><td class="description">物件中心Y座標</td></tr>
                        <tr><td class="field-name">area</td><td class="data-type">FLOAT</td><td class="required-no">❌</td><td>-</td><td class="description">物件面積 (像素)</td></tr>
                        <tr><td class="field-name">velocity_x</td><td class="data-type">FLOAT</td><td class="required-no">❌</td><td>-</td><td class="description">X方向速度 (像素/秒)</td></tr>
                        <tr><td class="field-name">velocity_y</td><td class="data-type">FLOAT</td><td class="required-no">❌</td><td>-</td><td class="description">Y方向速度 (像素/秒)</td></tr>
                        <tr><td class="field-name">velocity_magnitude</td><td class="data-type">FLOAT</td><td class="required-no">❌</td><td>-</td><td class="description">速度大小</td></tr>
                        <tr><td class="field-name">track_id</td><td class="data-type">VARCHAR(50)</td><td class="required-no">❌</td><td>-</td><td class="description">物件追蹤ID</td></tr>
                        <tr><td class="field-name">zone</td><td class="data-type">VARCHAR(50)</td><td class="required-no">❌</td><td>-</td><td class="description">檢測區域標識</td></tr>
                        <tr><td class="field-name">zone_chinese</td><td class="data-type">VARCHAR(50)</td><td class="required-no">❌</td><td>-</td><td class="description">區域中文名稱</td></tr>
                        <tr><td class="field-name">distance_to_camera</td><td class="data-type">FLOAT</td><td class="required-no">❌</td><td>-</td><td class="description">估計距攝影機距離</td></tr>
                        <tr><td class="field-name">relative_size</td><td class="data-type">FLOAT</td><td class="required-no">❌</td><td>-</td><td class="description">相對於畫面的大小比例</td></tr>
                        <tr><td class="field-name">is_moving</td><td class="data-type">BOOLEAN</td><td class="required-no">❌</td><td>-</td><td class="description">是否移動中</td></tr>
                        <tr><td class="field-name">occlusion_level</td><td class="data-type">FLOAT</td><td class="required-no">❌</td><td class="constraint">0.0-1.0</td><td class="description">遮擋程度</td></tr>
                        <tr><td class="field-name">quality_score</td><td class="data-type">FLOAT</td><td class="required-no">❌</td><td class="constraint">0.0-1.0</td><td class="description">檢測品質評分</td></tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Behavior Events Table -->
            <div class="table-section">
                <div class="table-header">
                    <h3>🎯 行為事件表 (behavior_events)</h3>
                    <p>儲存檢測到的行為事件、異常狀況和智慧分析結果</p>
                </div>
                
                <div class="ddl-code">
CREATE TABLE behavior_events (
    id                  SERIAL          PRIMARY KEY,
    created_at          TIMESTAMP       NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at          TIMESTAMP       DEFAULT CURRENT_TIMESTAMP,
    analysis_id         INTEGER         NOT NULL REFERENCES analysis_records(id) ON DELETE CASCADE,
    timestamp           FLOAT           NOT NULL,
    duration            FLOAT           DEFAULT NULL,
    event_type          VARCHAR(50)     NOT NULL,
    event_chinese       VARCHAR(50)     DEFAULT NULL,
    description         TEXT            DEFAULT NULL,
    severity            VARCHAR(20)     DEFAULT NULL,
    object_type         VARCHAR(50)     NOT NULL,
    object_chinese      VARCHAR(50)     DEFAULT NULL,
    position_x          FLOAT           DEFAULT NULL,
    position_y          FLOAT           DEFAULT NULL,
    zone                VARCHAR(50)     DEFAULT NULL,
    zone_chinese        VARCHAR(50)     DEFAULT NULL,
    participant_count   INTEGER         DEFAULT NULL,
    velocity            FLOAT           DEFAULT NULL,
    risk_score          FLOAT           DEFAULT NULL,
    alert_level         VARCHAR(20)     DEFAULT NULL,
    metadata            JSONB           DEFAULT NULL
);
                </div>
                
                <table class="field-table">
                    <thead>
                        <tr>
                            <th>欄位名稱</th>
                            <th>資料型別</th>
                            <th>必填</th>
                            <th>約束條件</th>
                            <th>說明</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td class="field-name">id</td><td class="data-type">SERIAL</td><td class="required-yes">✓</td><td class="constraint">PK</td><td class="description">主鍵，自動遞增</td></tr>
                        <tr><td class="field-name">created_at</td><td class="data-type">TIMESTAMP</td><td class="required-yes">✓</td><td>-</td><td class="description">建立時間戳記</td></tr>
                        <tr><td class="field-name">updated_at</td><td class="data-type">TIMESTAMP</td><td class="required-no">❌</td><td>-</td><td class="description">最後更新時間</td></tr>
                        <tr><td class="field-name">analysis_id</td><td class="data-type">INTEGER</td><td class="required-yes">✓</td><td class="constraint">FK, CASCADE</td><td class="description">關聯分析記錄ID</td></tr>
                        <tr><td class="field-name">timestamp</td><td class="data-type">FLOAT</td><td class="required-yes">✓</td><td>-</td><td class="description">事件發生時間點 (秒)</td></tr>
                        <tr><td class="field-name">duration</td><td class="data-type">FLOAT</td><td class="required-no">❌</td><td>-</td><td class="description">事件持續時間 (秒)</td></tr>
                        <tr><td class="field-name">event_type</td><td class="data-type">VARCHAR(50)</td><td class="required-yes">✓</td><td>-</td><td class="description">事件類型</td></tr>
                        <tr><td class="field-name">event_chinese</td><td class="data-type">VARCHAR(50)</td><td class="required-no">❌</td><td>-</td><td class="description">事件中文名稱</td></tr>
                        <tr><td class="field-name">description</td><td class="data-type">TEXT</td><td class="required-no">❌</td><td>-</td><td class="description">事件詳細描述</td></tr>
                        <tr><td class="field-name">severity</td><td class="data-type">VARCHAR(20)</td><td class="required-no">❌</td><td>-</td><td class="description">嚴重程度</td></tr>
                        <tr><td class="field-name">object_type</td><td class="data-type">VARCHAR(50)</td><td class="required-yes">✓</td><td>-</td><td class="description">相關物件類型</td></tr>
                        <tr><td class="field-name">object_chinese</td><td class="data-type">VARCHAR(50)</td><td class="required-no">❌</td><td>-</td><td class="description">物件中文名稱</td></tr>
                        <tr><td class="field-name">position_x</td><td class="data-type">FLOAT</td><td class="required-no">❌</td><td>-</td><td class="description">事件位置X座標</td></tr>
                        <tr><td class="field-name">position_y</td><td class="data-type">FLOAT</td><td class="required-no">❌</td><td>-</td><td class="description">事件位置Y座標</td></tr>
                        <tr><td class="field-name">zone</td><td class="data-type">VARCHAR(50)</td><td class="required-no">❌</td><td>-</td><td class="description">事件發生區域</td></tr>
                        <tr><td class="field-name">zone_chinese</td><td class="data-type">VARCHAR(50)</td><td class="required-no">❌</td><td>-</td><td class="description">區域中文名稱</td></tr>
                        <tr><td class="field-name">participant_count</td><td class="data-type">INTEGER</td><td class="required-no">❌</td><td>-</td><td class="description">參與事件的物件數量</td></tr>
                        <tr><td class="field-name">velocity</td><td class="data-type">FLOAT</td><td class="required-no">❌</td><td>-</td><td class="description">相關物件移動速度</td></tr>
                        <tr><td class="field-name">risk_score</td><td class="data-type">FLOAT</td><td class="required-no">❌</td><td class="constraint">0.0-1.0</td><td class="description">風險評分</td></tr>
                        <tr><td class="field-name">alert_level</td><td class="data-type">VARCHAR(20)</td><td class="required-no">❌</td><td>-</td><td class="description">警示等級</td></tr>
                        <tr><td class="field-name">metadata</td><td class="data-type">JSONB</td><td class="required-no">❌</td><td>-</td><td class="description">額外事件資料</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="footer">
            <p>📅 建立日期: 2025年7月23日 | 🏗️ YOLOv11 數位雙生分析系統</p>
            <p>資料庫類型: PostgreSQL | ORM: SQLAlchemy | 總欄位數: 68</p>
        </div>
    </div>
    
    <script>
        function openTab(evt, tabName) {
            var i, tabcontent, tabbuttons;
            
            // 隱藏所有 tab content
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].classList.remove("active");
            }
            
            // 移除所有 tab button 的 active class
            tabbuttons = document.getElementsByClassName("tab-button");
            for (i = 0; i < tabbuttons.length; i++) {
                tabbuttons[i].classList.remove("active");
            }
            
            // 顯示選中的 tab 並標記按鈕為 active
            document.getElementById(tabName).classList.add("active");
            evt.currentTarget.classList.add("active");
        }
        
        // 添加一些互動效果
        document.addEventListener('DOMContentLoaded', function() {
            // 為表格行添加點擊效果
            const tableRows = document.querySelectorAll('.field-table tbody tr');
            tableRows.forEach(row => {
                row.addEventListener('click', function() {
                    // 移除其他行的選中狀態
                    tableRows.forEach(r => r.style.background = '');
                    // 添加選中效果
                    this.style.background = '#007bff';
                    this.style.color = 'white';
                    
                    // 3秒後恢復原狀
                    setTimeout(() => {
                        this.style.background = '';
                        this.style.color = '';
                    }, 3000);
                });
            });
        });
    </script>
</body>
</html>
