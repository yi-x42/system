<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YOLOv11 è³‡æ–™åº« ERD - äº’å‹•å¼è¦–è¦ºåŒ–</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .controls {
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            text-align: center;
        }
        
        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }
        
        .btn.active {
            background: #4c51bf;
        }
        
        .content {
            padding: 30px;
        }
        
        .diagram-container {
            text-align: center;
            margin: 20px 0;
            min-height: 600px;
        }
        
        .info-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .info-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        
        .info-card h3 {
            margin: 0 0 15px 0;
            color: #2d3748;
        }
        
        .info-card ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .info-card li {
            margin: 8px 0;
            color: #4a5568;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }
        
        .stat-label {
            color: #718096;
            font-size: 0.9em;
            margin-top: 5px;
        }
        
        #mermaid-diagram {
            max-width: 100%;
            overflow-x: auto;
        }
        
        .legend {
            background: #e6fffa;
            border: 1px solid #81e6d9;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .legend h4 {
            margin: 0 0 10px 0;
            color: #234e52;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin: 5px 0;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
            margin-right: 10px;
        }
        
        .core-table { background: #4299e1; }
        .system-table { background: #48bb78; }
        .relation { background: #ed8936; }
        
        @media (max-width: 768px) {
            .header h1 { font-size: 2em; }
            .content { padding: 15px; }
            .info-panel { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¯ YOLOv11 æ•¸ä½é›™ç”Ÿåˆ†æç³»çµ±</h1>
            <p>è³‡æ–™åº«å¯¦é«”é—œä¿‚åœ– (ERD) - äº’å‹•å¼è¦–è¦ºåŒ–</p>
        </div>
        
        <div class="controls">
            <button class="btn active" onclick="showDiagram('full')">å®Œæ•´ ERD</button>
            <button class="btn" onclick="showDiagram('core')">æ ¸å¿ƒè¡¨çµæ§‹</button>
            <button class="btn" onclick="showDiagram('system')">ç³»çµ±ç®¡ç†è¡¨</button>
            <button class="btn" onclick="showInfo()">çµæ§‹èªªæ˜</button>
        </div>
        
        <div class="content">
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number">9</div>
                    <div class="stat-label">è³‡æ–™è¡¨ç¸½æ•¸</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">3</div>
                    <div class="stat-label">æ ¸å¿ƒæ¥­å‹™è¡¨</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">6</div>
                    <div class="stat-label">ç³»çµ±ç®¡ç†è¡¨</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">15+</div>
                    <div class="stat-label">é—œè¯é—œä¿‚</div>
                </div>
            </div>
            
            <div class="legend">
                <h4>ğŸ¨ åœ–ä¾‹èªªæ˜</h4>
                <div class="legend-item">
                    <div class="legend-color core-table"></div>
                    <span>æ ¸å¿ƒæ¥­å‹™è¡¨ (åˆ†æè¨˜éŒ„ã€æª¢æ¸¬çµæœã€è¡Œç‚ºäº‹ä»¶)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color system-table"></div>
                    <span>ç³»çµ±ç®¡ç†è¡¨ (ä½¿ç”¨è€…ã€æ”å½±æ©Ÿã€æ¨¡å‹ã€é…ç½®)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color relation"></div>
                    <span>é—œè¯é—œä¿‚ (ä¸€å°å¤šã€å¤šå°ä¸€)</span>
                </div>
            </div>
            
            <div class="diagram-container">
                <div id="mermaid-diagram"></div>
            </div>
            
            <div id="info-content" style="display: none;">
                <div class="info-panel">
                    <div class="info-card">
                        <h3>ğŸ¯ æ ¸å¿ƒæ¥­å‹™æµç¨‹</h3>
                        <ul>
                            <li>ä½¿ç”¨è€…ä¸Šå‚³å½±ç‰‡æˆ–é€£æ¥æ”å½±æ©Ÿ</li>
                            <li>é¸æ“‡ YOLO æ¨¡å‹é€²è¡Œåˆ†æ</li>
                            <li>ç³»çµ±å»ºç«‹åˆ†æè¨˜éŒ„è¿½è¹¤é€²åº¦</li>
                            <li>é€å¹€æª¢æ¸¬ä¸¦è¨˜éŒ„ç‰©ä»¶è³‡è¨Š</li>
                            <li>è­˜åˆ¥è¡Œç‚ºäº‹ä»¶ä¸¦åˆ†ç´šè™•ç†</li>
                            <li>ç”Ÿæˆåˆ†æå ±å‘Šå’Œå¯è¦–åŒ–çµæœ</li>
                        </ul>
                    </div>
                    
                    <div class="info-card">
                        <h3>ğŸ“Š è³‡æ–™é‡ä¼°ç®—</h3>
                        <ul>
                            <li><strong>å°å‹éƒ¨ç½²</strong>: 1-2 æ”å½±æ©Ÿï¼Œæ—¥è™•ç† 2-5 å½±ç‰‡</li>
                            <li><strong>ä¸­å‹éƒ¨ç½²</strong>: 5-10 æ”å½±æ©Ÿï¼Œæ—¥è™•ç† 20-50 å½±ç‰‡</li>
                            <li><strong>å¤§å‹éƒ¨ç½²</strong>: 20+ æ”å½±æ©Ÿï¼Œæ—¥è™•ç† 100+ å½±ç‰‡</li>
                            <li><strong>æª¢æ¸¬çµæœ</strong>: æ¯åˆ†é˜å½±ç‰‡ç´„ 1800 æ¢è¨˜éŒ„</li>
                            <li><strong>è¡Œç‚ºäº‹ä»¶</strong>: æ¯å°æ™‚å½±ç‰‡ç´„ 10-50 æ¢äº‹ä»¶</li>
                        </ul>
                    </div>
                    
                    <div class="info-card">
                        <h3>ğŸ”§ ç³»çµ±ç‰¹è‰²</h3>
                        <ul>
                            <li><strong>æ¨¡çµ„åŒ–è¨­è¨ˆ</strong>: æ ¸å¿ƒåŠŸèƒ½èˆ‡æ“´å±•åŠŸèƒ½åˆ†é›¢</li>
                            <li><strong>å¯æ“´å±•æ€§</strong>: æ”¯æ´å¤šæ”å½±æ©Ÿå’Œå¤šæ¨¡å‹</li>
                            <li><strong>å¯¦æ™‚ç›£æ§</strong>: åˆ†æé€²åº¦å’Œç³»çµ±ç‹€æ…‹è¿½è¹¤</li>
                            <li><strong>å®Œæ•´å¯©è¨ˆ</strong>: æ‰€æœ‰æ“ä½œéƒ½æœ‰æ—¥èªŒè¨˜éŒ„</li>
                            <li><strong>æ¬Šé™æ§åˆ¶</strong>: å¤šè§’è‰²ä½¿ç”¨è€…ç®¡ç†</li>
                        </ul>
                    </div>
                    
                    <div class="info-card">
                        <h3>âš¡ æ€§èƒ½å„ªåŒ–</h3>
                        <ul>
                            <li><strong>ç´¢å¼•ç­–ç•¥</strong>: ä¸»è¦æŸ¥è©¢æ¬„ä½å»ºç«‹ç´¢å¼•</li>
                            <li><strong>è³‡æ–™åˆ†å‰²</strong>: å¤§è¡¨æŒ‰æ™‚é–“åˆ†å‰²</li>
                            <li><strong>æ‰¹é‡è™•ç†</strong>: æª¢æ¸¬çµæœæ‰¹é‡æ’å…¥</li>
                            <li><strong>å¿«å–æ©Ÿåˆ¶</strong>: å¸¸ç”¨æŸ¥è©¢çµæœå¿«å–</li>
                            <li><strong>æ­¸æª”ç­–ç•¥</strong>: å®šæœŸæ¸…ç†æ­·å²è³‡æ–™</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: false,
            theme: 'default',
            themeVariables: {
                primaryColor: '#667eea',
                primaryTextColor: '#2d3748',
                primaryBorderColor: '#4c51bf',
                lineColor: '#718096',
                secondaryColor: '#ed8936',
                tertiaryColor: '#48bb78'
            }
        });

        const diagrams = {
            full: `
                erDiagram
                    ANALYSIS_RECORDS {
                        uuid id PK
                        varchar camera_id
                        varchar video_path
                        varchar status
                        timestamp created_at
                        timestamp updated_at
                        integer total_frames
                        integer processed_frames
                        json metadata
                    }
                    
                    DETECTION_RESULTS {
                        uuid id PK
                        uuid analysis_id FK
                        integer frame_number
                        varchar object_class
                        float confidence
                        float x_min
                        float y_min
                        float x_max
                        float y_max
                        timestamp detected_at
                    }
                    
                    BEHAVIOR_EVENTS {
                        uuid id PK
                        uuid analysis_id FK
                        varchar event_type
                        varchar severity
                        text description
                        integer start_frame
                        integer end_frame
                        timestamp event_time
                    }
                    
                    USERS {
                        uuid id PK
                        varchar username UK
                        varchar email UK
                        varchar role
                        boolean is_active
                        timestamp created_at
                    }
                    
                    CAMERAS {
                        varchar id PK
                        varchar name
                        varchar type
                        varchar connection_string
                        varchar status
                        uuid created_by FK
                    }
                    
                    YOLO_MODELS {
                        uuid id PK
                        varchar name
                        varchar version
                        varchar file_path
                        varchar model_type
                        boolean is_active
                        uuid created_by FK
                    }
                    
                    ANALYSIS_RECORDS ||--o{ DETECTION_RESULTS : contains
                    ANALYSIS_RECORDS ||--o{ BEHAVIOR_EVENTS : generates
                    USERS ||--o{ ANALYSIS_RECORDS : creates
                    USERS ||--o{ CAMERAS : manages
                    USERS ||--o{ YOLO_MODELS : uploads
                    ANALYSIS_RECORDS }o--|| CAMERAS : uses
                    ANALYSIS_RECORDS }o--|| YOLO_MODELS : processed_by
            `,
            
            core: `
                erDiagram
                    ANALYSIS_RECORDS {
                        uuid id PK
                        varchar camera_id
                        varchar video_path
                        varchar status
                        timestamp created_at
                        integer total_frames
                        integer processed_frames
                    }
                    
                    DETECTION_RESULTS {
                        uuid id PK
                        uuid analysis_id FK
                        integer frame_number
                        varchar object_class
                        float confidence
                        float x_min
                        float y_min
                        float x_max
                        float y_max
                    }
                    
                    BEHAVIOR_EVENTS {
                        uuid id PK
                        uuid analysis_id FK
                        varchar event_type
                        varchar severity
                        text description
                        timestamp event_time
                    }
                    
                    ANALYSIS_RECORDS ||--o{ DETECTION_RESULTS : contains
                    ANALYSIS_RECORDS ||--o{ BEHAVIOR_EVENTS : generates
            `,
            
            system: `
                erDiagram
                    USERS {
                        uuid id PK
                        varchar username UK
                        varchar email UK
                        varchar role
                        boolean is_active
                        timestamp created_at
                    }
                    
                    CAMERAS {
                        varchar id PK
                        varchar name
                        varchar type
                        varchar connection_string
                        varchar status
                        uuid created_by FK
                    }
                    
                    YOLO_MODELS {
                        uuid id PK
                        varchar name
                        varchar version
                        varchar file_path
                        varchar model_type
                        boolean is_active
                        uuid created_by FK
                    }
                    
                    SYSTEM_CONFIGURATIONS {
                        varchar key PK
                        varchar category
                        text value
                        uuid updated_by FK
                    }
                    
                    SYSTEM_LOGS {
                        uuid id PK
                        varchar level
                        varchar component
                        text message
                        timestamp created_at
                        uuid user_id FK
                    }
                    
                    FILE_UPLOADS {
                        uuid id PK
                        varchar original_name
                        varchar file_path
                        varchar upload_type
                        timestamp created_at
                        uuid uploaded_by FK
                    }
                    
                    USERS ||--o{ CAMERAS : manages
                    USERS ||--o{ YOLO_MODELS : uploads
                    USERS ||--o{ SYSTEM_CONFIGURATIONS : configures
                    USERS ||--o{ SYSTEM_LOGS : logs
                    USERS ||--o{ FILE_UPLOADS : uploads
            `
        };

        function showDiagram(type) {
            // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
            document.querySelectorAll('.btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // éš±è—èªªæ˜å…§å®¹
            document.getElementById('info-content').style.display = 'none';
            document.getElementById('mermaid-diagram').style.display = 'block';
            
            // æ¸²æŸ“åœ–è¡¨
            const diagramDiv = document.getElementById('mermaid-diagram');
            diagramDiv.innerHTML = '';
            
            mermaid.render('diagram-' + type, diagrams[type]).then(result => {
                diagramDiv.innerHTML = result.svg;
            });
        }
        
        function showInfo() {
            // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
            document.querySelectorAll('.btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // é¡¯ç¤ºèªªæ˜å…§å®¹
            document.getElementById('mermaid-diagram').style.display = 'none';
            document.getElementById('info-content').style.display = 'block';
        }

        // é è¨­é¡¯ç¤ºå®Œæ•´ ERD
        window.addEventListener('load', function() {
            showDiagram('full');
        });
    </script>
</body>
</html>