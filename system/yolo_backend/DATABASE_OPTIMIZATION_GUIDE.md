# 資料庫優化功能使用指南

## 🎯 功能概述

本系統現在提供了全面的資料庫優化功能，能夠自動清理和維護資料庫，移除多餘和無效的資料。

## 🚀 快速啟動

1. **啟動系統**
   ```powershell
   cd "d:\project\system\yolo_backend"
   python start.py
   ```

2. **訪問後台管理**
   - 本機訪問：http://localhost:8001/admin
   - Radmin 網絡：http://26.86.64.166:8001/admin

3. **使用資料庫管理**
   - 點擊左側導航的「資料庫管理」
   - 查看資料庫統計資訊
   - 使用快速操作功能

## 🔧 優化功能

### 全面優化按鈕功能：

✅ **自動清理項目**
- 移除重複的分析記錄
- 清理孤立的檢測結果（沒有對應分析記錄）
- 移除孤立的行為事件
- 清理過期的失敗分析記錄（7天前）
- 移除低信心度檢測結果（<0.3，3天前）
- 清理無檔案路徑的分析記錄
- 修正長時間處理狀態的記錄

✅ **資料庫維護**
- 執行 VACUUM ANALYZE（清理碎片）
- 重建索引
- 更新統計資訊
- 壓縮資料表空間

✅ **詳細報告**
- 顯示每項操作的結果
- 提供優化前後的統計對比
- 顯示資料表大小資訊

## 📊 可用操作

### 1. 清理舊資料（黃色按鈕）
- 刪除 30 天前的舊記錄
- 保留近期重要資料

### 2. 全面優化（藍色按鈕）
- 執行完整的資料庫優化
- 移除無效和重複資料
- 維護資料庫性能

### 3. 刪除所有資料（紅色按鈕）
- ⚠️ 危險操作：清空整個資料庫
- 雙重確認保護機制
- 建議事先備份

### 4. 建立備份（綠色按鈕）
- 匯出完整資料庫
- 安全備份功能

## 🧪 測試優化功能

運行測試腳本：
```powershell
python test_database_optimization.py
```

這會自動測試：
- 資料庫優化功能
- 統計資料更新
- 資料表查詢功能

## 💡 使用建議

### 日常維護
- **每日**：檢查資料庫統計
- **每週**：執行全面優化
- **每月**：建立完整備份

### 最佳實務
1. **優化前備份**：重要操作前先備份
2. **定期清理**：避免資料過度累積
3. **監控效果**：觀察優化後的效能改善
4. **調整策略**：根據使用情況調整優化頻率

### 優化時機
- 系統運行變慢時
- 資料累積過多時
- 檢測到重複資料時
- 定期維護時

## 🔍 監控指標

優化後關注以下指標：
- 記錄總數變化
- 資料表大小
- 查詢響應時間
- 系統整體效能

## ⚠️ 注意事項

1. **資料安全**：重要操作前先備份
2. **系統負載**：避免在系統繁忙時執行優化
3. **網絡訪問**：確保 Radmin 網絡連接穩定
4. **權限要求**：需要資料庫管理權限

## 🎨 介面特色

- **視覺化統計**：圖表顯示資料分布
- **即時更新**：操作後自動刷新統計
- **詳細回饋**：顯示每項操作的具體結果
- **響應式設計**：支援各種螢幕尺寸

---

📞 **技術支援**：如有問題請檢查系統日誌或聯繫管理員
