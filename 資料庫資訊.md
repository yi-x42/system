YOLOv11 æ•¸ä½é›™ç”Ÿåˆ†æç³»çµ± - è³‡æ–™åº«é‡è¨­è¨ˆæ–¹æ¡ˆ
==========================================================
æ—¥æœŸï¼š2025å¹´8æœˆ4æ—¥
ç›®æ¨™ï¼šé‡æ–°è¨­è¨ˆè³‡æ–™åº«æ¶æ§‹ï¼Œæ”¯æ´å³æ™‚æ”å½±æ©Ÿåˆ†æå’Œå½±ç‰‡æª”æ¡ˆåˆ†æå…©ç¨®æ¨¡å¼
ğŸ“‹ é è¨ˆå»ºç«‹çš„è³‡æ–™è¡¨ï¼ˆå…±6å€‹ï¼‰
==========================================================
## 1. analysis_tasks (åˆ†æä»»å‹™è¡¨)
id                    INTEGER      ä¸»éµ
task_type             VARCHAR(20)  'realtime_camera' | 'video_file'
status                VARCHAR(20)  'pending' | 'running' | 'paused' | 'completed' | 'failed'
source_id             INTEGER      é—œè¯ data_sources.id
source_width          INTEGER      ä¾†æºå½±åƒå¯¬åº¦ï¼ˆå°ˆç”¨æ¬„ä½ï¼‰
source_height         INTEGER      ä¾†æºå½±åƒé«˜åº¦ï¼ˆå°ˆç”¨æ¬„ä½ï¼‰
source_fps            FLOAT        ä¾†æºå½±åƒå¹€ç‡ï¼ˆå°ˆç”¨æ¬„ä½ï¼‰
start_time            TIMESTAMP    ä»»å‹™é–‹å§‹æ™‚é–“
end_time              TIMESTAMP    ä»»å‹™çµæŸæ™‚é–“
created_at            TIMESTAMP    å»ºç«‹æ™‚é–“
task_name             VARCHAR(200) ä»»å‹™åç¨±ï¼ˆç”¨æ–¼å‰ç«¯é¡¯ç¤ºï¼‰
camera_id             VARCHAR(100) æ”å½±æ©Ÿå”¯ä¸€è­˜åˆ¥ç¢¼
camera_name           VARCHAR(200) æ”å½±æ©Ÿåç¨±
camera_type           VARCHAR(50)  æ”å½±æ©Ÿé¡å‹ï¼ˆIP Camera å‹è™Ÿç­‰ï¼‰
device_index          INTEGER      æœ¬æ©Ÿ USB æ”å½±æ©Ÿçš„ã€Œè£ç½®åºè™Ÿã€
model_path            VARCHAR(255) YOLOæ¨¡å‹æª”æ¡ˆè·¯å¾‘
model_id              VARCHAR(100) ä½¿ç”¨çš„YOLOæ¨¡å‹IDï¼ˆå¦‚ï¼šyolo11n.ptï¼‰
confidence_threshold  FLOAT        ä¿¡å¿ƒåº¦é–¾å€¼ï¼ˆé è¨­0.5ï¼Œç”¨æ–¼ç‰©ä»¶è¾¨è­˜ï¼‰
iou_threshold         FLOAT        IOUé–¾å€¼ï¼ˆé è¨­0.4ï¼Œç”¨æ–¼éæ¥µå¤§å€¼æŠ‘åˆ¶ï¼‰
## 2. detection_results (æª¢æ¸¬çµæœè¡¨)
id               INTEGER      ä¸»éµ
task_id          INTEGER      é—œè¯ analysis_tasks.id
tracker_id       INTEGER      è¿½è¹¤å™¨çµ¦çš„ IDï¼Œè®“åŒä¸€å€‹äºº/è»Šè·¨å¹€ä¸²èµ·ä¾†ã€‚
object_speed     FLOAT        ç‰©ä»¶é€Ÿåº¦ 
zones            INTEGER      ç•¶ä¸‹æ‰€åœ¨å€åŸŸ
frame_number     INTEGER      å¹€ç·¨è™Ÿ
timestamp        TIMESTAMP    æª¢æ¸¬æ™‚é–“
object_type      VARCHAR(50)  ç‰©ä»¶é¡å‹ (person, car, bike...)
confidence       FLOAT        ä¿¡å¿ƒåº¦ (0.0-1.0)
bbox_x1          FLOAT        é‚Šç•Œæ¡†å·¦ä¸Šè§’X
bbox_y1          FLOAT        é‚Šç•Œæ¡†å·¦ä¸Šè§’Y
bbox_x2          FLOAT        é‚Šç•Œæ¡†å³ä¸‹è§’X
bbox_y2          FLOAT        é‚Šç•Œæ¡†å³ä¸‹è§’Y
center_x         FLOAT        ä¸­å¿ƒé»Xåº§æ¨™
center_y         FLOAT        ä¸­å¿ƒé»Yåº§æ¨™
## 3. line_crossing_events (ç©¿è¶Šç·šäº‹ä»¶è¡¨)
id               INTEGER      ä¸»éµ
is_enabled       BOOLEAN      æ˜¯å¦å•Ÿç”¨
task_id          INTEGER      é—œè¯ analysis_tasks.id
tracker_id       INTEGER      è§¸ç™¼äº‹ä»¶çš„è¿½è¹¤ ID
line_id          VARCHAR      å“ªä¸€æ¢ç·šï¼ˆç©¿è¶Šç·šäº‹ä»¶ç”¨ï¼Œç„¡å‰‡ NULLï¼‰ã€‚
direction        VARCHAR      ä¾‹å¦‚ in, out
frame_number     INTEGER      ç™¼ç”Ÿæ™‚çš„å½±æ ¼ç·¨è™Ÿ
frame_timestamp  TIMESTAMP    äº‹ä»¶ç™¼ç”Ÿæ™‚é–“
## 4. zone_dwell_events (å€åŸŸåœç•™äº‹ä»¶è¡¨) 
id               INTEGER      ä¸»éµ
is_enabled       BOOLEAN      æ˜¯å¦å•Ÿç”¨
task_id          INTEGER      é—œè¯ analysis_tasks.id
tracker_id       INTEGER      è§¸ç™¼äº‹ä»¶çš„è¿½è¹¤ ID
zone_id          VARCHAR      å“ªä¸€å€‹åœç•™å€åŸŸï¼ˆåœç•™äº‹ä»¶ç”¨ï¼‰ã€‚
entered_at       TIMESTAMP    é€²å…¥æ™‚é–“ï¼ˆåœç•™äº‹ä»¶ç”¨ï¼‰
exited_at        TIMESTAMP    é›¢é–‹æ™‚é–“ï¼ˆåœç•™äº‹ä»¶ç”¨ï¼‰
dwell_seconds    FLOAT        åœç•™ç§’æ•¸ï¼ˆåœç•™äº‹ä»¶ç”¨ï¼‰
frame_number     INTEGER      ç™¼ç”Ÿæ™‚çš„å½±æ ¼ç·¨è™Ÿ
frame_timestamp  TIMESTAMP    äº‹ä»¶ç™¼ç”Ÿæ™‚é–“
## 5. speed_events (é€Ÿåº¦äº‹ä»¶è¡¨)
id               INTEGER      ä¸»éµ
is_enabled       BOOLEAN      æ˜¯å¦å•Ÿç”¨
task_id          INTEGER      é—œè¯ analysis_tasks.id
tracker_id       INTEGER      è§¸ç™¼äº‹ä»¶çš„è¿½è¹¤ ID
speed_avg        FLOAT        å¹³å‡é€Ÿåº¦ï¼ˆç•°å¸¸é€Ÿåº¦äº‹ä»¶ç”¨ï¼‰
speed_max        FLOAT        æœ€å¤§é€Ÿåº¦ï¼ˆç•°å¸¸é€Ÿåº¦äº‹ä»¶ç”¨ï¼‰
frame_number     INTEGER      ç™¼ç”Ÿæ™‚çš„å½±æ ¼ç·¨è™Ÿ
frame_timestamp  TIMESTAMP    äº‹ä»¶ç™¼ç”Ÿæ™‚é–“
## 6. data_sources (è³‡æ–™ä¾†æºè¡¨)
id               INTEGER      ä¸»éµ
source_type      VARCHAR(20)  'camera' | 'video_file'
name             VARCHAR(100) ä¾†æºåç¨±
config           JSON         é…ç½®è³‡è¨Šï¼ˆIPã€æª”æ¡ˆè·¯å¾‘ç­‰ï¼‰
status           VARCHAR(20)  'active' | 'inactive' | 'error'
last_check       TIMESTAMP    æœ€å¾Œæª¢æŸ¥æ™‚é–“
created_at       TIMESTAMP    å»ºç«‹æ™‚é–“
## 7. task_statistics (ä»»å‹™çµ±è¨ˆè¡¨)
task_id            INTEGER      ä¸»éµã€é—œè¯ analysis_tasks.idï¼ˆ1:1ï¼Œæ¯å€‹ä»»å‹™ä¸€ç­†æœ€æ–°çµ±è¨ˆï¼‰
updated_at         TIMESTAMP    æœ€å¾Œæ›´æ–°æ™‚é–“
fps                FLOAT        è¿‘ä¼¼çš„è™•ç† FPS
person_count       INTEGER      ç›®å‰åµæ¸¬åˆ°çš„äººæ•¸
avg_confidence     FLOAT        ç•¶å‰å¹³å‡ä¿¡å¿ƒå€¼
line_stats         JSON         å„ç©¿è¶Šç·šçš„ç´¯è¨ˆé€²å‡ºçµ±è¨ˆï¼ˆä¾‹ï¼š{"line_A":{"in":12,"out":5}})
zone_stats         JSON         å„åœç•™å€çš„å³æ™‚/å¹³å‡/æœ€é•·è³‡è¨Šï¼ˆä¾‹ï¼š{"zone_1":{"current":3,"avg":4.2,"max":12.0}})
## 8. users (ä½¿ç”¨è€…è¡¨)  (ç¨‹å¼å…ˆä¸è¦åšé€™éƒ¨åˆ†)
id               INTEGER      ä¸»éµ
username         VARCHAR(50)  ä½¿ç”¨è€…åç¨±
password_hash    VARCHAR(255) å¯†ç¢¼é›œæ¹Š
role             VARCHAR(20)  'admin' | 'operator' | 'viewer'
is_active        BOOLEAN      æ˜¯å¦å•Ÿç”¨
last_login       TIMESTAMP    æœ€å¾Œç™»å…¥æ™‚é–“
created_at       TIMESTAMP    å»ºç«‹æ™‚é–“
## 9. system_config (ç³»çµ±é…ç½®è¡¨)
id               INTEGER      ä¸»éµ
config_key       VARCHAR(100) é…ç½®éµå€¼
config_value     TEXT         é…ç½®å€¼
description      TEXT         èªªæ˜
updated_at       TIMESTAMP    æ›´æ–°æ™‚é–“
==========================================================
ğŸ“Š é—œè¯é—œä¿‚èªªæ˜
==========================================================
1. data_sources â†’ analysis_tasks (1:N)  
é—œä¿‚: åŒä¸€è³‡æ–™ä¾†æºå¯è¢«å¤šå€‹åˆ†æä»»å‹™å…±ç”¨  
å¯¦ç¾: analysis_tasks é€é `source_info` æˆ– `source_id` æŒ‡å‘ data_sources
ç¯„ä¾‹:  
data_sources.id = 1 (å¤§å»³æ”å½±æ©ŸA)  
  â”œâ”€â”€ analysis_tasks.id = 10 (ä»Šå¤©ä¸Šåˆçš„ç›£æ§)  
  â”œâ”€â”€ analysis_tasks.id = 11 (ä»Šå¤©ä¸‹åˆçš„ç›£æ§)  
  â””â”€â”€ analysis_tasks.id = 12 (æ˜¨å¤©æ™šä¸Šçš„ç›£æ§)

2. analysis_tasks â†’ detection_results (1:N)  
é—œä¿‚: æ¯å€‹ä»»å‹™æœƒç”¢å‡ºå¤šç­†åµæ¸¬ç´€éŒ„  
å¯¦ç¾: detection_results.task_id â†’ analysis_tasks.id (FK)ï¼Œä¸¦ä»¥ `tracker_id` ä¸²è¯è·¨å¹€åŒä¸€è¿½è¹¤ç‰©
ç¯„ä¾‹:  
analysis_tasks.id = 10 (30 åˆ†é˜å³æ™‚ç›£æ§)  
  â”œâ”€â”€ detection_results 54,000 ç­† (30 åˆ†é˜ Ã— 30fps Ã— 60 ç§’)  
  â””â”€â”€ æ¯ç­†åŒ…å« bboxã€confidenceã€zonesã€tracker_id ç­‰è³‡è¨Š

3. analysis_tasks â†’ line_crossing_events (1:N)  
é—œä¿‚: æ¯å€‹ä»»å‹™å¯é…ç½®å¤šæ¢ç©¿è¶Šç·šï¼Œç”¢ç”Ÿå¤šç­†ç©¿è¶Šäº‹ä»¶  
å¯¦ç¾: line_crossing_events.task_id â†’ analysis_tasks.idï¼Œäº‹ä»¶å…§å®¹å« `line_id`ã€`direction`ã€`tracker_id`
ç¯„ä¾‹:  
analysis_tasks.id = 10  
  â”œâ”€â”€ line_crossing_events.id = 2001 (Line A é€²å…¥)  
  â”œâ”€â”€ line_crossing_events.id = 2002 (Line A é›¢é–‹)  
  â””â”€â”€ line_crossing_events.id = 2003 (Line B é€²å…¥)

4. analysis_tasks â†’ zone_dwell_events (1:N)  
é—œä¿‚: æ¯å€‹ä»»å‹™å¯è¨­å®šå¤šå€‹åœç•™å€åŸŸï¼Œè¿½è¹¤åœç•™é–‹å§‹/çµæŸèˆ‡æ™‚é•·  
å¯¦ç¾: zone_dwell_events.task_id â†’ analysis_tasks.idï¼Œäº‹ä»¶ç´€éŒ„ `zone_id`ã€`entered_at`ã€`exited_at`ã€`dwell_seconds`
ç¯„ä¾‹:  
analysis_tasks.id = 10  
  â”œâ”€â”€ zone_dwell_events.id = 3101 (Zone 1 é€²å…¥)  
  â”œâ”€â”€ zone_dwell_events.id = 3102 (Zone 1 åœç•™ 6.5 ç§’å¾Œé›¢é–‹)  
  â””â”€â”€ zone_dwell_events.id = 3103 (Zone 2 é€²å…¥)

5. analysis_tasks â†’ speed_events (1:N)  
é—œä¿‚: ä»»å‹™åµæ¸¬åˆ°çš„é€Ÿåº¦ç•°å¸¸æœƒè¨˜éŒ„åœ¨ç¨ç«‹äº‹ä»¶è¡¨  
å¯¦ç¾: speed_events.task_id â†’ analysis_tasks.idï¼ŒåŒ…å« `tracker_id`ã€`speed_avg`ã€`speed_max`ã€`threshold` ç­‰

6. detection_results â†” äº‹ä»¶è¡¨ (line/zone/speed)  
é—œä¿‚: äº‹ä»¶è¡¨é€é `tracker_id` èˆ‡ `frame_timestamp` å›æº¯åˆ°åµæ¸¬ç´€éŒ„  
ç”¨é€”: äº‹ä»¶éœ€è¦å–å¾—ç•¶ä¸‹çš„ bboxã€ä½ç½®ã€speed æ™‚ï¼Œå¯ join detection_results

7. users â†’ analysis_tasks (1:N)ã€è¦åŠƒä¸­ã€‘  
é—œä¿‚: ä¸€å€‹ä½¿ç”¨è€… (users) å¯ä»¥å»ºç«‹å¤šå€‹åˆ†æä»»å‹™  
å»ºè­°: analysis_tasks åŠ ä¸Š user_id (FK)ï¼Œæ–¹ä¾¿æ¬Šé™èˆ‡å¯©è¨ˆ

8. system_config â†’ å…¨åŸŸè¨­å®š (ç¨ç«‹è¡¨)  
é—œä¿‚: ç³»çµ±é…ç½®å½±éŸ¿æ‰€æœ‰æ¨¡çµ„è¡Œç‚º  
ä½¿ç”¨: å„æ¨¡çµ„è®€å–å°æ‡‰è¨­å®šï¼Œå¦‚ä»»å‹™åŒæ™‚ä¸Šé™ã€å‘Šè­¦é–¾å€¼ã€è³‡æ–™ä¿ç•™å¤©æ•¸ç­‰
å½±éŸ¿ç¯„åœç¯„ä¾‹:  
â”œâ”€â”€ analysis_tasksï¼šä»»å‹™é è¨­åƒæ•¸/ä¸Šé™  
â”œâ”€â”€ detection_resultsï¼šAI æ¨è«–é–¾å€¼ã€ä¿ç•™ç­–ç•¥  
â”œâ”€â”€ line_crossing_events / zone_dwell_eventsï¼šå‘Šè­¦é–€æª»ã€è¨ˆç®—è¦å‰‡  
â””â”€â”€ data_sourcesï¼šæ”å½±æ©Ÿé è¨­é€£ç·šè³‡è¨Š
